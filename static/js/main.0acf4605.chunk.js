(this["webpackJsonpecoled-collage"]=this["webpackJsonpecoled-collage"]||[]).push([[0],{127:function(e,t,n){"use strict";n.r(t);var a=n(2),i=n.n(a),o=n(52),r=n.n(o),l=(n(67),n(35)),c=n(36),s=n(15),d=n(53),u=n.n(d),h=n(19),f=n(34),g=n(37),m=n.n(g),p=n(28),b=n(136),w=n(54);function y(){var e=Object(l.a)(["\n      query query {\n        shop {\n          name\n        }\n      }\n    "]);return y=function(){return e},e}function v(){var e=Object(l.a)(['\n      query query {\n        node(id: "','") {\n          ... on Product {\n            images(first: 100) {\n              edges {\n                node {\n                  originalSrc\n                  altText\n                }\n              }\n            }\n          }\n        }\n      }\n    ']);return v=function(){return e},e}var x=Object(b.a)({outerContainer:{height:"100vh",display:"flex"},stageContainerBeforeUpload:{},stageContainerAfterUpload:{width:"100%",alignContent:"center",alignItems:"center"},buttonContainerAfterUpload:{width:"100%",position:"absolute",bottom:0,display:"flex",justifyContent:"space-evenly"},buttonContainerBeforeUpload:{width:"100%"},singleButtonContainerBeforeUpload:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},singleButtonContainerAfterUpload:{width:"48%",display:"flex",justifyContent:"center",alignItems:"center"},button:{background:"#252a2b",fontFamily:"sans-serif",fontStyle:"normal",color:"white",border:"2px solid transparent",fontWeight:700,textTransform:"uppercase",cursor:"pointer",borderRadius:0,padding:"15px 30px",textAlign:"center",width:"100%",alignSelf:"stretch"},buttonLabel:{width:"100%"},buttonBeforeUpload:{background:"#252a2b",fontFamily:"sans-serif",fontStyle:"normal",color:"white",border:"2px solid transparent",fontWeight:700,textTransform:"uppercase",cursor:"pointer",borderRadius:0,padding:"15px 30px",width:"50%",display:"flex",alignSelf:"center",justifyContent:"center"}}),C=function(e){var t,n,a=e.data,o=e.shapeProps,r=e.isSelected,l=e.onSelect,d=e.onChange,f=i.a.useState(null),g=Object(s.a)(f,2),m=g[0],p=g[1];a&&a.node&&a.node.images&&0!==a.node.images.edges.length&&null===m&&a.node.images.edges.forEach((function(e){"collage"===e.node.altText&&p(e.node.originalSrc)}));var b=u()(m,"Anonymous"),w=Object(s.a)(b,1)[0];if(w&&o&&null===o.height&&null===o.width){var y=w.width/w.height;n=(t=window.innerHeight/4)*y,o.width=n,o.height=t}var v=i.a.useRef(),x=i.a.useRef();return i.a.useEffect((function(){r&&(x.current.setNode(v.current),x.current.getLayer().batchDraw())}),[r]),console.log(o),i.a.createElement(i.a.Fragment,null,i.a.createElement(h.Image,Object.assign({crossOrigin:"anonymus",fill:"",image:w,onTap:l,onClick:l,ref:v},o,{draggable:!0,onDragEnd:function(e){d(Object(c.a)({},o,{x:e.target.x(),y:e.target.y()}))},onTransformEnd:function(e){var t=v.current,n=t.scaleX(),a=t.scaleY();t.scaleX(1),t.scaleY(1),d(Object(c.a)({},o,{x:t.x(),y:t.y(),width:Math.max(5,t.width()*n),height:Math.max(t.height()*a)}))}})),r&&i.a.createElement(h.Transformer,{ref:x,boundBoxFunc:function(e,t){return t.width<5||t.height<5?e:t}}))},j=function(){var e,t=window.location.search,n=new URLSearchParams(t).get("product_id");e=n?m()(v(),n):m()(y());var a=x(),o=Object(f.a)(e).data,r=i.a.createRef(),l=new Image,c=i.a.useState(null),d=Object(s.a)(c,2),u=d[0],g=d[1],b=i.a.useState(null),j=Object(s.a)(b,2),E=j[0],S=j[1],O=i.a.useState(!1),B=Object(s.a)(O,2),U=B[0],k=B[1],A=i.a.useState(window.innerHeight),T=Object(s.a)(A,2),N=T[0],I=T[1],R=i.a.useState(window.innerWidth),W=Object(s.a)(R,2),L=W[0],q=W[1],F=i.a.useState(null),H=Object(s.a)(F,2),M=H[0],P=H[1],D=i.a.useState(null),X=Object(s.a)(D,2),J=X[0],Y=X[1],$=i.a.useState(null),_=Object(s.a)($,2),z=_[0],G=_[1];function K(){!0===window.matchMedia("(orientation: portrait)").matches?Y("landscape"):Y("portrait");var e=N,t=L;if(u){var n=p.scale(u,{maxWidth:e,maxHeight:t});S(n);var a=(e-n.width)/2,i=(t-n.height)/2;G({x:a,y:i}),P({x:a,y:i,width:null,height:null})}I(t),q(e)}i.a.useEffect((function(){window.onorientationchange=function(){var e=this;K(),this.setTimeout((function(){e.window.innerHeight!==N&&K()}),400)}}),[u,l]);var Q=!1;null!==u&&(Q=!0);return!1===window.matchMedia("(orientation: ".concat(J," )"))&&K(),i.a.createElement("div",{className:a.outerContainer},i.a.createElement("div",{className:Q?a.stageContainerAfterUpload:a.stageContainerBeforeUpload},i.a.createElement(h.Stage,{visible:Q,ref:r,width:L,height:N},i.a.createElement(h.Layer,{onClick:function(){k(!1)},onTap:function(){k(!1)}},i.a.createElement(h.Image,{x:M?z.x:0,y:M?z.y:0,image:E})),i.a.createElement(h.Layer,{visible:Q},i.a.createElement(C,{data:o,shapeProps:M,isSelected:U,onSelect:function(){k(!0)},onChange:P})))),i.a.createElement("div",{className:Q?a.buttonContainerAfterUpload:a.buttonContainerBeforeUpload},i.a.createElement("div",{className:Q?a.singleButtonContainerAfterUpload:a.singleButtonContainerBeforeUpload},i.a.createElement("label",{className:Q?a.button:a.buttonBeforeUpload,htmlFor:"files"},"Bild hochladen",i.a.createElement("input",{id:"files",visibility:"hidden",type:"file",accept:"image/*",style:{display:"none"},onChange:function(e){var t=Object(s.a)(e.target.files,1)[0];t&&p(t,(function(e){var t,n,a=p.scale(e,{maxWidth:L,maxHeight:N});(S(a),g(e),a.width<L)&&(t=(L-a.width)/2);a.height<N&&(n=(N-a.height)/2);G({x:t,y:n}),null===M&&P({x:t,y:n,width:null,height:null})}),{orientation:!0})}}))),i.a.createElement("div",{style:Q?{visibility:"visible"}:{visibility:"hidden"},className:a.singleButtonContainerAfterUpload},i.a.createElement("label",{className:a.button,onClick:function(){k(!1);var e=r.current.toDataURL({mimeType:"image/png"});Object(w.saveAs)(e,"collage.png")}},"Bild Speichern"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var E=n(17),S=n(59),O=n(60),B=n(61),U=n(12),k=new O.a,A=new B.a({uri:"https://picture-collage-development-store.myshopify.com/api/graphql"}),T=Object(S.a)((function(){return{headers:{"X-Shopify-Storefront-Access-Token":"6ffce0a3460c1eac5a62e776d6d292bb"}}})),N=new E.a({link:T.concat(A),cache:k});r.a.render(i.a.createElement(U.a,{client:N},i.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},62:function(e,t,n){e.exports=n(127)},67:function(e,t,n){}},[[62,1,2]]]);
//# sourceMappingURL=main.0acf4605.chunk.js.map